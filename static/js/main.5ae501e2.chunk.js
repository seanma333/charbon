(this.webpackJsonpcharbon=this.webpackJsonpcharbon||[]).push([[0],{34:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var r=a(0),i=a.n(r),s=a(14),n=a.n(s),c=(a(34),a(9)),o=a(10),l=a(12),u=a(11),d=a(8),h=a(63),b=a(61),p=a(58),f=a(28),j=a(59),v=a(23),y=a(62),O=a(27),g=a(1),m=function(){function e(t){Object(c.a)(this,e),this.diceRolls=[];var a=t.replace(/\s+/g,"");if(/(\d*)d(\d+)((([+-])(((\d*)d(\d+))|(\d+)))*|(kh|kl|dh|dl)(\d+))/.test(a)){var r=/(\d*)d(\d+)(kh|kl|dh|dl)(\d+)/.exec(a);if(r)this.diceRolls.push({numDice:parseInt(r[1]),diceSize:parseInt(r[2]),action:r[3],static:parseInt(r[4])});else for(var i=/([+-])?(((\d*)d(\d+))|(\d+))/g;r=i.exec(a);)r[3]?this.diceRolls.push({numDice:r[4]?parseInt(r[4]):1,diceSize:parseInt(r[5]),action:r[1]?r[1]:"+",static:0}):r[6]&&this.diceRolls.push({numDice:0,diceSize:0,action:r[1]?r[1]:"+",static:parseInt(r[6])})}else console.log("invalid expression: "+a)}return Object(o.a)(e,[{key:"keepNRolls",value:function(e,t,a){return e.sort((function(e,t){return a?t-e:e-t})),e.slice(0,t)}},{key:"roll",value:function(){var e=this;return this.diceRolls.reduce((function(t,a){for(var r=[],i=0;i<a.numDice;i++)r.push(Math.floor(Math.random()*a.diceSize)+1);switch(a.action){case"+":return t+r.reduce((function(e,t){return e+t}),0)+a.static;case"-":return t-(r.reduce((function(e,t){return e+t}),0)+a.static);case"dl":return t+e.keepNRolls(r,r.length-a.static,!0).reduce((function(e,t){return e+t}),0);case"kh":return t+e.keepNRolls(r,a.static,!0).reduce((function(e,t){return e+t}));case"dh":return t+e.keepNRolls(r,r.length-a.static,!1).reduce((function(e,t){return e+t}),0);case"kl":return t+e.keepNRolls(r,a.static,!1).reduce((function(e,t){return e+t}));default:return console.log("unknown action: "+a.action),t}}),0)}}]),e}();function x(e,t){return e.id=t+"_"+e.name.toLowerCase().replaceAll(" ","_"),e.hasOwnProperty("choices")?(e.complete=!1,e.choices=e.choices.map((function(e){return e.selected=[],e}))):e.complete=!0,e}function k(e){return Object(g.jsxs)("div",{children:[Object(g.jsx)("h6",{children:e.title},"title"),Object(g.jsx)(O.Multiselect,{options:e.choices,onSelect:e.onUpdate,onRemove:e.onUpdate,selectionLimit:e.limit,selectedValues:e.preselected,displayValue:"displayName",showCheckbox:!0,avoidHighlightFirstOption:!0,hidePlaceholder:!0,closeOnSelecte:!1},e.id)]})}var S=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).data=r.props.data,r.feature=r.props.feature,r.onUpdate=r.props.onUpdate,r.featureTypes=r.feature.types,r.state={complete:r.complete},r}return Object(o.a)(a,[{key:"updateFeatureState",value:function(){var e=this;this.feature.hasOwnProperty("choices")&&(this.feature.choices.every((function(e){switch(e.type){case"asi":return e.num_abilities===e.selected.length;case"language_proficiency":return e.num_languages===e.selected.length;case"skill_proficiency":return e.num_skills===e.selected.length;case"tool_proficiency":return e.num_tools===e.selected.length;default:return!0}}))?this.feature.complete=!0:this.feature.complete=!1,this.setState((function(t){return t.complete=e.feature.complete,t})),this.props.onUpdate(this.feature))}},{key:"renderChoices",value:function(){var e=this;return this.feature.hasOwnProperty("choices")?0===this.feature.choices.length?Object(g.jsx)("div",{}):this.feature.choices.map((function(t){var a="Select ",r=[],i=t.selected,s=null;switch(t.type){case"asi":r=Object.entries(e.data.abilityScores).map((function(e){var t=Object(d.a)(e,2);return{key:t[0],displayName:t[1].name}})).filter((function(e){return!t.excludes.includes(e.key)})),a+=1===(s=t.num_abilities)?"an ability score to increase by "+t.increase:t.num_abilities+" ability scores to increase by "+t.increase;break;case"language_proficiency":r=Object.entries(e.data.languages).map((function(e){var t=Object(d.a)(e,2);return{key:t[0],displayName:t[1].name}})).filter((function(e){return!t.excludes.includes(e.key)})),a+=1===(s=t.num_languages)?"a language":t.num_languages+" languages";break;case"skill_proficiency":r=Object.entries(e.data.skills).map((function(t){var a=Object(d.a)(t,2),r=a[0],i=a[1];return{key:r,displayName:i.name+" ("+e.data.abilityScores[i.ability].shortName+")"}})).filter((function(e){return!t.excludes.includes(e.key)})),a+=1===(s=t.num_skills)?"a skill":t.num_skills+" skills";break;case"tool_proficiency":r=Object.entries(e.data.tools).map((function(e){var t=Object(d.a)(e,2);return{key:t[0],displayName:t[1].name}})).filter((function(e){return!t.excludes.includes(e.key)})),a+=1===(s=t.num_tools)?"a tool":t.num_tools+" tools";break;default:return Object(g.jsx)("div",{})}return Object(g.jsx)(k,{id:e.feature.id,title:a,choices:r,preselected:i,limit:s,onUpdate:function(a){t.selected=a,e.updateFeatureState()}})})):Object(g.jsx)("div",{})}},{key:"render",value:function(){var e=Object(v.a)(this.feature.description),t=this.renderChoices(),a=this.feature.complete?"primary":"secondary";return Object(g.jsx)("div",{children:Object(g.jsxs)(y.a,{border:a,className:"feature-card",children:[Object(g.jsx)(y.a.Title,{children:this.feature.name}),Object(g.jsxs)(y.a.Body,{children:[Object(g.jsx)(p.a,{children:e},"description"),Object(g.jsx)(p.a,{children:t},"choices")]})]})},this.feature.id)}}]),a}(i.a.Component);function _(e){if(null===e.name)return Object(g.jsx)("div",{});var t=Object(v.a)(e.description);return Object(g.jsxs)("div",{className:"description",children:[Object(g.jsx)("h2",{children:e.name}),t]})}function C(e){return e.enabled?Object(g.jsx)(h.a,{className:"saveButton",variant:"primary",onClick:e.onClick,children:e.value}):Object(g.jsx)(h.a,{className:"saveButton",variant:"primary",disabled:!0,children:e.value})}function w(e){var t=e.selected?"primary":"outline-primary";return Object(g.jsx)(h.a,{className:"selector",variant:t,onClick:e.onClick,children:e.value})}function N(e){return Object.keys(e.options).map((function(t){return Object(g.jsx)(p.a,{children:Object(g.jsx)(w,{value:e.options[t].name,selected:t===e.selected,onClick:function(){return e.onClick(t)}})},t)}))}var M=a(60),D=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;Object(c.a)(this,a),(r=t.call(this,e)).originData=e.data,r.featureData=e.featureData;var i=null,s=null;return e.current.originStep?(i=e.current.originStep.origin,s=e.current.originStep.suborigin,r.availableSuborigins=r.originData[i].suborigins,r.selectedOriginFeatures=e.current.features.filter((function(e){return"origin"===e.source})),r.selectedSuboriginFeatures=e.current.features.filter((function(e){return"suborigin"===e.source}))):(r.availableSuborigins={},r.selectedOriginFeatures=[],r.selectedSuboriginFeatures=[]),r.state={selectedOrigin:i,selectedSuborigin:s},r}return Object(o.a)(a,[{key:"selectOrigin",value:function(e){var t=[];null!==e&&this.originData.hasOwnProperty(e)&&(t=this.originData[e].features.map((function(t){return x(t,"origin_"+e)}))),this.selectedOriginFeatures=t,this.selectedOriginFeatures.sort((function(e,t){var a=e.hasOwnProperty("choices")?e.choices.length:0;return(t.hasOwnProperty("choices")?t.choices.length:0)-a})),this.originData[e].hasOwnProperty("suborigins")?this.availableSuborigins=this.originData[e].suborigins:this.availableSuborigins={},this.selectedSuboriginFeatures=[],this.setState({selectedOrigin:e,selectSuborigin:null},this.onUpdate)}},{key:"selectSuborigin",value:function(e){var t=[];null!==e&&this.availableSuborigins.hasOwnProperty(e)&&(t=this.availableSuborigins[e].features.map((function(t){return x(t,"suborigin_"+e)}))),this.selectedSuboriginFeatures=t,this.selectedSuboriginFeatures.sort((function(e,t){var a=e.hasOwnProperty("choices")?e.choices.length:0;return(t.hasOwnProperty("choices")?t.choices.length:0)-a})),this.setState({selectedOrigin:this.state.selectedOrigin,selectedSuborigin:e},this.onUpdate)}},{key:"onUpdate",value:function(){this.props.onUpdate({origin:this.state.selectedOrigin,originFeatures:this.selectedOriginFeatures,noSuborigins:0===Object.entries(this.availableSuborigins).length,suborigin:this.state.selectedSuborigin,suboriginFeatures:this.selectedSuboriginFeatures})}},{key:"renderSelected",value:function(){var e=this,t=this.state.selectedOrigin,a=this.state.selectedSuborigin;if(null===t||!(t in this.originData))return Object(g.jsx)("div",{});var r=this.originData[t],i={name:null,description:null};null!==a&&a in this.availableSuborigins&&(i=this.availableSuborigins[a]);var s=this.selectedOriginFeatures.map((function(t){return Object(g.jsx)(p.a,{children:Object(g.jsx)(S,{feature:t,data:e.featureData,onUpdate:function(){return e.onUpdate()}})},t.id)})),n=this.selectedSuboriginFeatures.map((function(t){return Object(g.jsx)(p.a,{children:Object(g.jsx)(S,{feature:t,data:e.featureData,onUpdate:function(){return e.onUpdate()}})},t.id)}));return Object(g.jsxs)("div",{children:[Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{md:7,children:Object(g.jsx)(_,{name:r.name,description:r.description})}),Object(g.jsx)(f.a,{lg:1}),Object(g.jsxs)(f.a,{lg:4,children:[Object(g.jsx)(p.a,{children:Object(g.jsx)(N,{options:this.availableSuborigins,selected:this.state.selectedSuborigin,onClick:function(t){return e.selectSuborigin(t)}})}),Object(g.jsx)(p.a,{children:Object(g.jsx)(_,{name:i.name,description:i.description})})]})]}),Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{md:6,children:s}),Object(g.jsx)(f.a,{md:6,children:n})]})]})}},{key:"render",value:function(){var e=this,t=this.renderSelected();return Object(g.jsx)(j.a,{children:Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{lg:2,children:Object(g.jsx)(N,{options:this.originData,selected:this.state.selectedOrigin,onClick:function(t){return e.selectOrigin(t)}})}),Object(g.jsx)(f.a,{lg:10,children:t})]})})}}]),a}(i.a.Component),A=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).selected=null,r.state={saveable:!1},r}return Object(o.a)(a,[{key:"updateOrigin",value:function(e){var t=!1;this.selected=e,null!==this.selected.origin&&this.selected.originFeatures.every((function(e){return e.complete}))&&(this.selected.noSuborigins||null!==this.selected.suborigin&&this.selected.suboriginFeatures.every((function(e){return e.complete})))&&(t=!0),this.setState({saveable:t})}},{key:"saveOrigin",value:function(){var e={origin:this.selected.origin,suborigin:this.selected.suborigin},t=this.selected.originFeatures.map((function(e){return e.source="origin",e}));this.selected.noSuborigins||this.selected.suboriginFeatures.forEach((function(e){e.source="suborigin",t.push(e)})),this.props.handleSave({originStep:e,features:t})}},{key:"render",value:function(){var e=this;return Object(g.jsxs)(M.a,{className:"creatorStep",size:"lg",show:this.props.show,onHide:this.props.handleClose,scrollable:!0,children:[Object(g.jsx)(M.a.Header,{children:Object(g.jsx)(M.a.Title,{children:"Select Origin"})}),Object(g.jsx)(M.a.Body,{className:"show-grid",children:Object(g.jsx)(D,{data:this.props.data,featureData:this.props.featureData,current:this.props.current,onUpdate:function(t){return e.updateOrigin(t)}})}),Object(g.jsxs)(M.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:this.props.handleClose,children:"Close"}),Object(g.jsx)(C,{value:"Save Origin",enabled:this.state.saveable,onClick:function(){return e.saveOrigin()}})]})]})}}]),a}(i.a.Component);function E(e){return Object(g.jsx)(p.a,{children:Object(g.jsx)(f.a,{className:"justify-content-center",children:Object(g.jsx)("div",{className:"dice",children:Object(g.jsx)("div",{className:"dice-face",children:Object(g.jsx)("div",{className:"dice-face-table",children:Object(g.jsx)("div",{className:"dice-face-table-cell",children:e.value})})})})})})}var U=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"rollDiceArray",value:function(e){for(var t=[],a=new m(this.props.roll),r=0;r<e;r++)t.push(a.roll());t.sort((function(e,t){return t-e})),this.props.onRoll(t)}},{key:"renderDice",value:function(){return this.props.array.map((function(e){return Object(g.jsx)(E,{value:e})}))}},{key:"render",value:function(){var e=this;return Object(g.jsxs)(j.a,{fluid:!0,children:[Object(g.jsx)(p.a,{h25:!0,className:"mb-4",children:this.props.roll?Object(g.jsx)("div",{className:"mb-1",children:Object(g.jsx)(h.a,{onClick:function(){return e.rollDiceArray(6)},children:"Roll "+this.props.roll})}):Object(g.jsx)("div",{className:"mb-5"})}),Object(g.jsx)(p.a,{children:Object(g.jsx)(f.a,{children:this.renderDice()})})]})}}]),a}(i.a.Component);function R(e){return Object(g.jsx)(p.a,{className:"align-items-center h-100 point-buy-display",children:Object(g.jsxs)(f.a,{children:[Object(g.jsx)(p.a,{children:Object(g.jsx)("p",{children:"Points Left:"})}),Object(g.jsx)(p.a,{children:Object(g.jsx)("p",{children:e.pointsLeft})})]})})}function F(e){var t=e.array.map((function(e){return e}));e.arrayUsed.forEach((function(e){t.splice(t.findIndex((function(t){return t===e})),1)})),e.selected&&!t.includes(e.selected)&&(t.push(e.selected),t.sort((function(e,t){return t-e})));var a=t.map((function(e){return Object(g.jsx)("option",{value:e,children:e})}));return a.push(Object(g.jsx)("option",{value:"",children:"--"})),Object(g.jsx)(b.a,{children:Object(g.jsx)(b.a.Control,{as:"select",value:e.selected?e.selected:"",onChange:function(t){return e.onChange(parseInt(t.target.value))},children:a})})}var P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).state={value:e.value},r}return Object(o.a)(a,[{key:"getMax",value:function(){switch(this.props.data.pointsLeft){case 0:return this.state.value;case 1:return this.state.value>13?this.props.value:this.state.value+1;default:return 15}}},{key:"updateValue",value:function(e){var t=this.getMax();e>t?e=t:e<8&&(e=8),this.setState({value:e}),this.props.onChange(e)}},{key:"onChange",value:function(e){"1"!==e&&""!==e&&this.updateValue(parseInt(e))}},{key:"onBlur",value:function(e){""===e?this.updateValue(8):this.updateValue(parseInt(e))}},{key:"render",value:function(){var e=this,t=this.getMax();return Object(g.jsx)(b.a,{children:Object(g.jsx)(b.a.Control,{type:"number",min:8,max:t,value:this.state.value,onChange:function(t){return e.onChange(t.target.value)},size:"lg"})})}}]),a}(i.a.Component);function B(e){var t=Object(g.jsx)("div",{style:{textAlign:"center"},children:"--"});if(e.data.isActive){var a={};a=e.data.isArray?Object(g.jsx)(F,{array:e.data.array,arrayUsed:e.data.arrayUsed,selected:e.data.selected,onChange:function(t){return e.onSelect([e.type,t])}}):Object(g.jsx)(P,{value:e.data.selected,data:e.data,onChange:function(t){return e.onSelect([e.type,t])}});var r=e.data.bonus,i="--";if(e.data.selected){var s=e.data.selected+r,n=Math.floor((s-10)/2);i=n<0?s+" (-"+-n+")":s+" (+"+n+")"}t=Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{md:4,children:a}),Object(g.jsx)(f.a,{md:1,textCenter:!0,children:r<0?"-":"+"}),Object(g.jsx)(f.a,{md:2,textCenter:!0,children:r}),Object(g.jsx)(f.a,{md:1,textCenter:!0,children:"="}),Object(g.jsx)(f.a,{md:4,textCenter:!0,children:i})]})}return Object(g.jsx)(y.a,{className:"abilityScoreCard mb-2 mt-2",children:Object(g.jsx)(y.a.Body,{children:Object(g.jsxs)(j.a,{children:[Object(g.jsx)(p.a,{children:Object(g.jsx)(y.a.Title,{style:{textAlign:"center"},children:e.name})}),Object(g.jsx)(p.a,{children:t})]})})})}var L=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;if(Object(c.a)(this,a),(r=t.call(this,e)).abilityScoreData=e.data,r.methods={carbonRoll:{displayName:"Carbon 2185 Dice Roll (2d6+5)",roll:"2d6+5"},carbonArray:{displayName:"Carbon 2185 Standard Array (16,14,13,12,10,9)",roll:null},dndRoll:{displayName:"D&D 5E Dice Roll (4d6 drop lowest)",roll:"4d6dl1"},dndPointBuy:{displayName:"D&D 5E Point Buy (27 points)",roll:null}},r.rolling=!1,r.arrayGenerated=!1,r.bonuses={},Object.keys(r.abilityScoreData).forEach((function(e){return r.bonuses[e]=0})),e.current.features.filter((function(e){return e.types.includes("asi")})).forEach((function(e){e.hasOwnProperty("ability_score_increase")&&e.ability_score_increase.forEach((function(e){return r.bonuses[e.ability]+=e.increase})),e.hasOwnProperty("choices")&&e.choices.filter((function(e){return"asi"===e.type})).forEach((function(e){e.selected.forEach((function(t){r.bonuses[t.key]+=e.increase}))}))})),e.current.abilitiesStep){r.selectedScores=e.current.baseAbilities;var i=e.current.abilitiesStep.generationMethod;if("dndPointBuy"===i)r.state={selectedMethod:i,array:[],arrayUsed:[],pointsLeft:27-r.calculatePointTotal()};else{r.rolling="carbonRoll"===i||"dndRoll"===i,r.arrayGenerated=!0;var s=Object.values(r.selectedScores);s.sort((function(e,t){return t-e})),r.state={selectedMethod:i,array:s,arrayUsed:s,pointsLeft:27}}}else r.selectedScores={},Object.keys(r.abilityScoreData).forEach((function(e){return r.selectedScores[e]=null})),r.state={selectedMethod:null,array:[],arrayUsed:[],pointsLeft:27};return r}return Object(o.a)(a,[{key:"changeMethod",value:function(e){var t=this,a=[];switch(Object.keys(this.abilityScoreData).forEach((function(e){return t.selectedScores[e]=null})),e){case"carbonRoll":case"dndRoll":this.rolling=!0,this.arrayGenerated=!1,a=[];break;case"carbonArray":this.rolling=!1,this.arrayGenerated=!0,a=[16,14,13,12,10,9];break;case"dndPointBuy":this.rolling=!1,this.arrayGenerated=!1,a=[],Object.keys(this.abilityScoreData).forEach((function(e){return t.selectedScores[e]=8}));break;default:return}this.setState({selectedMethod:e,array:a,arrayUsed:[],pointsLeft:27}),this.updateSaveable()}},{key:"calculatePointTotal",value:function(){var e=[0,1,2,3,4,5,7,9];return Object.values(this.selectedScores).reduce((function(t,a){return a<8?t:a>15?t+(2*(a-15)+9):t+e[a-8]}),0)}},{key:"updateScore",value:function(e,t){var a=this.state.arrayUsed.map((function(e){return e})),r=this.state.pointsLeft;switch(this.state.selectedMethod){case"dndPointBuy":this.selectedScores[e]=t,r=27-this.calculatePointTotal();break;case"dndRoll":case"carbonRoll":case"carbonArray":this.selectedScores[e]=t,a=Object.values(this.selectedScores).filter((function(e){return e}));break;default:return}this.setState({selectedMethod:this.state.selectedMethod,array:this.state.array,arrayUsed:a,pointsLeft:r}),this.updateSaveable()}},{key:"updateArray",value:function(e){var t=this;Object.keys(this.abilityScoreData).forEach((function(e){return t.selectedScores[e]=null})),this.arrayGenerated=e.length===Object.keys(this.abilityScoreData).length,this.setState({selectedMethod:this.state.selectedMethod,array:e,arrayUsed:[],pointsLeft:27}),this.updateSaveable()}},{key:"updateSaveable",value:function(){var e=this,t=Object.keys(this.abilityScoreData).every((function(t){return e.selectedScores[t]}));this.props.onUpdate({scores:this.selectedScores,selectedMethod:this.state.selectedMethod,saveable:t})}},{key:"render",value:function(){var e=this,t=Object.entries(this.methods).map((function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];return Object(g.jsx)("option",{value:a,children:r.displayName})}));t.push(Object(g.jsx)("option",{hidden:!0,value:"",children:"--"}));var a=this.state.selectedMethod?this.state.selectedMethod:"",r=Object.entries(this.abilityScoreData).map((function(t){var a=Object(d.a)(t,2),r=a[0],i=a[1],s={};switch(e.state.selectedMethod){case"carbonRoll":case"dndRoll":case"carbonArray":s.isActive=e.arrayGenerated,s.isArray=!0,s.selected=e.selectedScores[r],s.array=e.state.array,s.arrayUsed=e.state.arrayUsed,s.bonus=e.bonuses[r];break;case"dndPointBuy":s.isActive=!0,s.isArray=!1,s.selected=e.selectedScores[r],s.pointsLeft=e.state.pointsLeft,s.bonus=e.bonuses[r];break;default:s.isActive=!1}return Object(g.jsx)(p.a,{children:Object(g.jsx)(B,{name:i.name.toUpperCase(),data:s,type:r,onSelect:function(t){var a=Object(d.a)(t,2),r=a[0],i=a[1];return e.updateScore(r,i)}})})})),i=Object(g.jsx)("div",{});switch(this.state.selectedMethod){case"dndPointBuy":i=Object(g.jsx)(R,{pointsLeft:this.state.pointsLeft});break;case"carbonRoll":case"dndRoll":case"carbonArray":i=Object(g.jsx)(U,{array:this.state.array,arrayUsed:this.state.arrayUsed,roll:this.methods[this.state.selectedMethod].roll,onRoll:function(t){return e.updateArray(t)}})}return Object(g.jsxs)(j.a,{children:[Object(g.jsx)(p.a,{children:Object(g.jsx)(b.a,{children:Object(g.jsxs)(b.a.Group,{children:[Object(g.jsx)(b.a.Label,{children:"Select Stat Generation Method"}),Object(g.jsx)(b.a.Control,{as:"select",value:a,onChange:function(t){return e.changeMethod(t.target.value)},children:t})]})})}),Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{md:8,children:r}),Object(g.jsx)(f.a,{md:4,children:i})]})]})}}]),a}(i.a.Component),T=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).abilityKeys=Object.keys(e.data),r.generationMethod=null,r.abilityScores={},r.state={saveable:!1},r}return Object(o.a)(a,[{key:"updateAbilityScores",value:function(e){var t=this;this.abilityKeys.forEach((function(a){return t.abilityScores[a]=e.scores[a]})),this.generationMethod=e.selectedMethod,this.setState({saveable:e.saveable})}},{key:"saveAbilityScores",value:function(){console.log(this.abilityScores);var e={generationMethod:this.generationMethod};this.props.handleSave({abilitiesStep:e,baseAbilities:this.abilityScores})}},{key:"render",value:function(){var e=this;return Object(g.jsxs)(M.a,{className:"creatorStep",size:"lg",show:this.props.show,onHide:this.props.handleClose,scrollable:!0,children:[Object(g.jsx)(M.a.Header,{children:Object(g.jsx)(M.a.Title,{children:"Select Your Ability Scores"})}),Object(g.jsx)(M.a.Body,{className:"show-grid",children:Object(g.jsx)(L,{data:this.props.data,current:this.props.current,onUpdate:function(t){return e.updateAbilityScores(t)}})}),Object(g.jsxs)(M.a.Footer,{children:[Object(g.jsx)(h.a,{variant:"secondary",onClick:this.props.handleClose,children:"Close"}),Object(g.jsx)(C,{value:"Save Ability Scores",enabled:this.state.saveable,onClick:function(){return e.saveAbilityScores()}})]})]})}}]),a}(i.a.Component);function I(e){var t=e.value.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" ");switch(e.status){case 1:return Object(g.jsx)(h.a,{className:"stepButton",size:"lg",onClick:function(){return e.onClick()},children:t},e.value);case 2:return Object(g.jsx)(h.a,{className:"stepButton",size:"lg",variant:"success",onClick:function(){return e.onClick()},children:t},e.value);default:return Object(g.jsx)(h.a,{className:"stepButton",size:"lg",disabled:!0,children:t},e.value)}}var z=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).onSave=e.onSave,r.placeholderText="Enter Character Name",r.name=r.props.name?r.props.name:"",r.state={edit:e.editingName,saveable:!!r.name},r}return Object(o.a)(a,[{key:"toggleEdit",value:function(){this.setState({edit:!this.state.edit,saveable:this.state.saveable})}},{key:"handleChange",value:function(e){this.name=e.target.value,this.setState({edit:this.state.edit,saveable:!!this.name})}},{key:"saveName",value:function(){this.onSave(this.name),this.setState({edit:!1,saveable:!!this.name})}},{key:"render",value:function(){var e=this;if(this.state.edit)return Object(g.jsx)(b.a,{className:"characterName",children:Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{md:9,children:Object(g.jsx)(b.a.Control,{placeholder:this.placeholderText,onChange:function(t){return e.handleChange(t)},value:this.name})}),Object(g.jsx)(f.a,{md:3,children:Object(g.jsx)(C,{value:"Save Name",onClick:function(){return e.saveName()},enabled:this.state.saveable,size:"lg"})})]})});var t=this.name?this.name:this.placeholderText;return Object(g.jsx)(b.a,{className:"characterName",children:Object(g.jsx)(b.a.Control,{plaintext:!0,readOnly:!0,defaultValue:t,size:"lg",onClick:function(){return e.toggleEdit()}})})}}]),a}(i.a.Component);function G(e){var t=JSON.stringify(e.character,null,4);return Object(g.jsx)("div",{style:{height:"600px"},children:Object(g.jsx)("pre",{style:{maxHeight:"100%"},children:t})})}var V=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).data=r.props.data,r.steps=[{name:"origin",status:1},{name:"abilities",status:0},{name:"career",status:0},{name:"class",status:0},{name:"buy_gear",status:0},{name:"level_up",status:0},{name:"next_steps",status:0}],r.character=r.getBaseCharacter(),r.character.name=null,r.character.age=null,r.character.features=[],r.state={editingName:!1,openStep:null},r}return Object(o.a)(a,[{key:"getBaseCharacter",value:function(){var e=JSON.parse(JSON.stringify(this.data.baseCharacterValues));return e.level=1,e}},{key:"openStep",value:function(e){this.setState((function(t){return t.openStep=e,t}))}},{key:"closeStep",value:function(){this.setState((function(e){return e.openStep=null,e}))}},{key:"saveStep",value:function(e,t){var a=this;this.character.features=this.character.features.filter((function(e){return e.step!==t}));var r=!1;this.steps.forEach((function(e){e.name===t?(e.status=2,r=!0):r&&(0===e.status&&(e.status=1),r=!1)}));var i=[];console.log(e),Object.entries(e).forEach((function(e){var r=Object(d.a)(e,2),s=r[0],n=r[1];switch(s){case"features":n.forEach((function(e){e.step=t,i.push(e)}));break;case"baseAbilities":console.log(n),a.character.baseAbilities={},Object.entries(n).forEach((function(e){var t=Object(d.a)(e,2),r=t[0],i=t[1];a.character.baseAbilities[r]=i}));break;default:a.character[s]=n}})),i.forEach((function(e){return a.character.features.push(e)})),this.buildCharacter(),this.closeStep()}},{key:"saveCharacterName",value:function(e){this.character.name=e,this.setState((function(e){return e.editingName=!1,e}))}},{key:"buildCharacter",value:function(){var e=this,t=this.getBaseCharacter();function a(e,a){a.forEach((function(a){t[e].includes(a)||t[e].push(a)}))}if(this.steps.forEach((function(a){t[a.name+"Step"]=e.character[a.name+"Step"]})),this.character.baseAbilities&&(console.log(this.character.baseAbilities),t.baseAbilities={},t.abilityScores={},Object.entries(this.character.baseAbilities).forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=a[1];t.baseAbilities[r]=i,t.abilityScores[r]=i}))),t.features=this.character.features,t.features.forEach((function(e){e.types.forEach((function(r){switch(r){case"age":t.age_range=e.age;break;case"base_speed":t.base_speed=e.speed;break;case"climb_speed":t.climb_speed=e.speed;break;case"asi":t.abilityScores&&(console.log(t.abilityScores),e.ability_score_increase.forEach((function(e){t.abilityScores[e.ability]+=e.increase})));break;case"skill_proficiency":a("skill_proficiencies",e.skill_proficiencies);break;case"tool_proficiency":a("tool_proficiencies",e.tool_proficiencies);break;case"weapon_proficiency":a("weapon_proficiencies",e.weapon_proficiencies);break;case"armor_proficiency":a("armor_proficiencies",e.armor_proficiencies);break;case"language_proficiency":a("languages",e.languages);break;case"darkvision":t.senses.filter((function(e){return"darkvision"===e.type})).length>0?t.senses=t.senses.map((function(t){return"darkvision"!==t.type||t.range>e.darkvision_range?t:{type:"darkvision",range:e.darkvision_range}})):t.senses.push({type:"darkvision",range:e.darkvision_range});break;case"weapon_override":t.weapon_overrides[e.weapon_type]=e.weapon_override;break;case"natural_armor":t.natural_armor=e.natural_base_ac;break;case"damage_resistance":a("damage_resistances",e.damage_types);break;case"bonus_action":t.bonus_actions.push({name:e.name,description:e.description});break;case"influence":Object.entries(e.influence).forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=a[1];t.baseInfluence[r]=Math.max(t.baseInfluence[r],i)}));break;default:console.log("Missing static: "+r)}})),e.hasOwnProperty("choices")&&e.choices.forEach((function(e){switch(e.type){case"asi":t.abilityScores&&e.selected.forEach((function(a){t.abilityScores[a]+=e.increase}));break;case"skill_proficiency":a("skill_proficiencies",e.selected.map((function(e){return e.key})));break;case"tool_proficiency":a("tool_proficiencies",e.selected.map((function(e){return e.key})));break;case"weapon_proficiency":a("weapon_proficiencies",e.selected.map((function(e){return e.key})));break;case"armor_proficiency":a("armor_proficiencies",e.selected.map((function(e){return e.key})));break;case"language_proficiency":a("languages",e.selected.map((function(e){return e.key})));break;default:console.log("Missing choice: "+e.type)}}))})),t.abilityScores){if(t.abilityMods={},Object.entries(t.abilityScores).forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=a[1];t.abilityMods[r]=Math.floor((i-10)/2)})),t.armor=this.character.armor,t.helmet=this.character.helmet,t.armor){var r=this.data.armor[t.armor];switch(r.category){case"light":t.ac=r.base_ac+t.abilityMods.dexterity;break;case"medium":t.ac=r.base_ac+Math.max(2,t.abilityMods.dexterity);break;case"heavy":t.ac=r.base_ac;break;default:t.ac=t.natural_armor+t.abilityMods.dexterity}}else t.ac=t.natural_armor+t.abilityMods.dexterity;if(t.helmet){var i=this.data.armor[t.helmet];t.ac+=i.base_ac}if(t.level=this.character.level,t.level){var s=[2,2,2,2,3,3,3,3,4,4][Math.max(t.level-1,0)];t.skillMods={},Object.entries(this.data.skills).forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=(a[1],t.skill_half_proficiencies.includes(r)?Math.round(s/2):0),n=t.skill_proficiencies.includes(r)?s:0,c=t.skill_expertise.includes(r)?2*s:0;t.skillMods[r]=Math.max(i,n,c)})),t.weapons=this.character.weapons,t.attacks=t.weapons.map((function(a){var r=JSON.parse(JSON.stringify(e.data.weapons[a.type]));t.weapon_overrides[a.type]&&Object.entries(t.weapon_overrides[a.type]).forEach((function(e){var t=Object(d.a)(e,2),a=t[0],i=t[1];console.log(a),console.log(i),r[a]=i,console.log(r)}));var i=t.abilityMods.dexterity;["melee","unarmed","heavy_weapons"].includes(r.category)&&(i=r.properties.includes("finesse")?Math.max(t.abilityMods.strength,t.abilityMods.dexterity):t.abilityMods.strength);var n=i+(t.weapon_proficiencies.some((function(e){return e.category===r.category||e.type===a.type}))?s:0),c=r.damage_dice+"+"+i;return{type:a.type,name:r.name,attackBonus:n,damageRoll:c,damageType:r.damage_type,range:r.range}})),this.character=t}else this.character=t}else this.character=t}},{key:"render",value:function(){var e=this,t=this.steps.map((function(t){return Object(g.jsx)(p.a,{children:Object(g.jsx)(I,{value:t.name,status:t.status,onClick:function(){return e.openStep(t.name)}})},t.name)}));return Object(g.jsx)("div",{children:Object(g.jsxs)(j.a,{children:[Object(g.jsxs)(p.a,{children:[Object(g.jsx)(f.a,{lg:2,children:t}),Object(g.jsxs)(f.a,{lg:10,children:[Object(g.jsx)(p.a,{children:Object(g.jsx)(z,{name:this.character.name,editingName:this.state.editingName,onSave:function(t){return e.saveCharacterName(t)}})}),Object(g.jsx)(p.a,{children:Object(g.jsx)(G,{character:this.character})})]})]}),Object(g.jsx)(A,{show:"origin"===this.state.openStep,current:this.character,data:this.data.origins,featureData:{abilityScores:this.data.abilityScores,tools:this.data.tools,skills:this.data.skills,languages:this.data.languages},handleClose:function(){return e.closeStep()},handleSave:function(t){return e.saveStep(t,"origin")}}),Object(g.jsx)(T,{show:"abilities"===this.state.openStep,current:this.character,data:this.data.abilityScores,handleClose:function(){return e.closeStep()},handleSave:function(t){return e.saveStep(t,"abilities")}})]})})}}]),a}(i.a.Component),J=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).snakeToCamel=function(e){return e.replace(/([-_][a-z])/g,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},r.state={loaded:!1},r}return Object(o.a)(a,[{key:"fetchData",value:function(){var e=this;if(!this.state.loaded){this.data={};Promise.all(["ability_scores","ammo","armor","gear","languages","origins","skills","tools","vices","weapons","base_character_values"].map((function(t){return fetch("./json/"+t+".json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(a){return a.json().then((function(a){var r=e.snakeToCamel(t);return e.data[r]=a,!0}))}))}))).then((function(t){e.setState({loaded:!0})}))}}},{key:"render",value:function(){return this.fetchData(),this.state.loaded?Object(g.jsx)(V,{data:this.data}):Object(g.jsx)("div",{children:"LOADING"})}}]),a}(i.a.Component),H=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,64)).then((function(t){var a=t.getCLS,r=t.getFID,i=t.getFCP,s=t.getLCP,n=t.getTTFB;a(e),r(e),i(e),s(e),n(e)}))};a(54),a(55);n.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(J,{})}),document.getElementById("root")),H()}},[[56,1,2]]]);
//# sourceMappingURL=main.5ae501e2.chunk.js.map